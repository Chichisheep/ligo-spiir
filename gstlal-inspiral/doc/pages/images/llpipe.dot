digraph llpipe {
	graph [fontname="Roman", fontsize=11];
	edge [ fontname="Roman", fontsize=10 ];
	node [fontname="Roman", shape=box, fontsize=11];

	H1 [label="H1 Observatory:\nO(10)s h(t) generation\nlatency", color=red1, style=filled];
	L1 [label="L1 Observatory:\nO(10)s h(t) generation\nlatency", color=green1, style=filled];
	V1 [label="V1 Observatory:\nO(10)s h(t) generation\nlatency", color=magenta1, style=filled];

	HeadNode [
		style=filled, color=grey,
		label = <<TABLE>
			<TR><TD colspan="3"><B>CIT Head Node</B></TD></TR>
         		<TR>
				<TD href="\ref gstlal_inspiral_marginalize_likelihoods_online"> gstlal_inspiral_marginalize_likelihoods_online | </TD>
				<TD> HTCondor dagman | </TD>
				<TD> lvalert_listen </TD>
			</TR>
        		</TABLE>>
		]

	WebServer [
		style=filled, color=grey,
		label = <<TABLE>
			<TR><TD colspan="3"><B>CIT Web Server</B></TD></TR>
         		<TR>
				<TD href="\ref gstlal_llcbcsummary"> gstlal_llcbcsummary | </TD>
				<TD href="\ref gstlal_llcbcnode"> gstlal_llcbcsummary | </TD>
			</TR>
        		</TABLE>>
		];

	HomeDir [
		style=filled, color=grey,
		label = <<TABLE>
			<TR><TD colspan="3"><B>CIT File System</B></TD></TR>
         		<TR>
				<TD> Input Files | </TD>
				<TD> Output Files | </TD>
				<TD> Background Files | </TD>
			</TR>
        		</TABLE>>
		];

	gracedb [label="GW Candidate Database\nO(1)s processing time", shape=oval, color=tomato3, style=filled];

	H1 -> HeadNode [label="TCP link", color=red4];
	L1 -> HeadNode [label="TCP link", color=green4];
	V1 -> HeadNode [label="TCP link", color=magenta4];

	subgraph clusterCIT { 

		label="CIT HTCondor Pool";
		fontsize = 14;
		style=rounded;
		labeljust="l";

		Node1 [label="Node 1\ngstlal_inspiral\nO(10)s processing\nlatency", URL="\ref gstlal_inspiral"];
		Node2 [label="Node 2\ngstlal_inspiral\nO(10)s processing\nlatency", URL="\ref gstlal_inspiral"];
		NodeN [label="Node N\ngstlal_inspiral\nO(10)s processing\nlatency", URL="\ref gstlal_inspiral"];

		HeadNode -> HomeDir [dir="both", label="nfs"] ;
		HomeDir -> Node1 [dir="both", label="nfs"];
		HomeDir -> Node2 [dir="both", label="nfs"];
		HomeDir -> NodeN [dir="both", label="nfs"];
		HomeDir -> WebServer [dir="both", label="nfs"];

		HeadNode -> Node1 [color=red4];
		HeadNode -> Node1 [color=green4];
		HeadNode -> Node1 [color=magenta4, label="UDP multicast"];

		HeadNode -> Node2 [color=red4];
		HeadNode -> Node2 [color=green4];
		HeadNode -> Node2 [color=magenta4, label="UDP multicast"];

		HeadNode -> NodeN [color=red4];
		HeadNode -> NodeN [color=green4];
		HeadNode -> NodeN [color=magenta4, label="UDP multicast"];

		Node1 -> HeadNode [dir=both, label="http"];
		Node2 -> HeadNode [dir=both, label="http"];
		NodeN -> HeadNode [dir=both, label="http"];
		HeadNode -> WebServer [label="nfs"];

	}

	HeadNode -> gracedb [dir="both", label="https"] ;
	Node1 -> gracedb [label="https"];
	Node2 -> gracedb [label="https"];
	NodeN -> gracedb [label="https"];
}
